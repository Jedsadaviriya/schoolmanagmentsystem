(()=>{var e={};e.id=397,e.ids=[397],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2518:e=>{"use strict";e.exports=require("mongodb")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},7455:(e,t,s)=>{"use strict";s.d(t,{$:()=>u});var r=s(2518);let n=process.env.MONGODB_URI||"mongodb://localhost:27017/schoolManagementSystem",o=process.env.MONGODB_DB||"schoolManagementSystem";if(!n)throw Error("Please define MONGODB_URI in your .env.local file");let i=null;async function u(){try{let e=await i,t=e.db(o);return{client:e,db:t}}catch(e){throw console.error("MongoDB connection error:",e),Error("Failed to connect to database")}}i=new r.MongoClient(n).connect()},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9740:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>h,routeModule:()=>v,serverHooks:()=>x,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>m});var r={};s.r(r),s.d(r,{DELETE:()=>p,GET:()=>d,PUT:()=>l});var n=s(6559),o=s(8088),i=s(7719),u=s(2190),c=s(7455),a=s(2518);async function d(e,{params:t}){try{let{id:e,eventId:s}=t;if(!a.ObjectId.isValid(e))return u.NextResponse.json({success:!1,error:"Ung\xfcltige Modul-ID"},{status:400});let{db:r}=await (0,c.$)(),n=await r.collection("modules").findOne({_id:new a.ObjectId(e),"events._id":s},{projection:{"events.$":1}});if(!n||!n.events||0===n.events.length)return u.NextResponse.json({success:!1,error:"Ereignis nicht gefunden"},{status:404});return u.NextResponse.json({success:!0,event:n.events[0]})}catch(e){return console.error("Error fetching event:",e),u.NextResponse.json({success:!1,error:"Fehler beim Laden des Ereignisses"},{status:500})}}async function l(e,{params:t}){try{let{id:s,eventId:r}=t,n=await e.json();if(!a.ObjectId.isValid(s))return u.NextResponse.json({success:!1,error:"Ung\xfcltige Modul-ID"},{status:400});let{db:o}=await (0,c.$)(),i={};n.title&&(i["events.$.title"]=n.title),n.date&&(i["events.$.date"]=n.date),void 0!==n.description&&(i["events.$.description"]=n.description);let d=await o.collection("modules").updateOne({_id:new a.ObjectId(s),"events._id":r},{$set:i});if(0===d.matchedCount)return u.NextResponse.json({success:!1,error:"Ereignis oder Modul nicht gefunden"},{status:404});return u.NextResponse.json({success:!0})}catch(e){return console.error("Error updating event:",e),u.NextResponse.json({success:!1,error:"Fehler beim Aktualisieren des Ereignisses"},{status:500})}}async function p(e,{params:t}){try{let{id:e,eventId:s}=t;if(!a.ObjectId.isValid(e))return u.NextResponse.json({success:!1,error:"Ung\xfcltige Modul-ID"},{status:400});let{db:r}=await (0,c.$)(),n=await r.collection("modules").updateOne({_id:new a.ObjectId(e)},{$pull:{events:{_id:s}}});if(0===n.matchedCount)return u.NextResponse.json({success:!1,error:"Modul nicht gefunden"},{status:404});if(0===n.modifiedCount)return u.NextResponse.json({success:!1,error:"Ereignis nicht gefunden"},{status:404});return u.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting event:",e),u.NextResponse.json({success:!1,error:"Fehler beim L\xf6schen des Ereignisses"},{status:500})}}let v=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/modules/[id]/events/[eventId]/route",pathname:"/api/modules/[id]/events/[eventId]",filename:"route",bundlePath:"app/api/modules/[id]/events/[eventId]/route"},resolvedPagePath:"C:\\Users\\Janjao\\GitHub\\schoolmanagmentsystem\\src\\app\\api\\modules\\[id]\\events\\[eventId]\\route.js",nextConfigOutput:"",userland:r}),{workAsyncStorage:g,workUnitAsyncStorage:m,serverHooks:x}=v;function h(){return(0,i.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:m})}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[719,580],()=>s(9740));module.exports=r})();